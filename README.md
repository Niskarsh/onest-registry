## **Registry APIâ€™s**
### Network Provider Registration
- **POST** *register()* ->  np_public_unique_identifier/np_id (if provided), registry_sdk_link, np_challenge_string
Request body:
```json
{
 np_name,
 np_id,
 np_public_key,
 np_get_resource_url,
 np_user_related_operations_webhook,
 np_details
}

```

### User Registration/Signin
- On user signup or signin, Bap will redirect user to registry_sdk_link provided during bap registration.

> signature = np_challenge_string signed in by private key generated by BAP during registration.

- Bap calls the link mentioned **below**
	- **GET** registry_sdk_link?pkey=np_public_key&signature=signature&purpose=signup/signin
	- Mobile is verifed on **Registry platform** as well.

- Once user signup/signin in done. Registry calls ***np_user_related_operations_webhook*** provided buring BAP registration as below
	 - **POST** *np_user_related_operations_webhook*
Request body:
```json
{
 user_np_specific_id,
 user_unique_id,
 user_mobile,
 purpose: signup/signin
}
```

### Network Provider Document API's
- Once user is onboarded on the network, they can start uploading documents to be verified.
- For this, user uploads document on BAP plaform. Once user uploads documents, they are redirected to registry platform to declare proof of consent for uploading said documents to be verified.
	- **GET** registry_sdk_link?pkey=np_public_key&signature=signature&purpose=documentVerificationDeclaration

- Once user is done declaring documents they have uploaded to BAP.  Registry calls ***np_user_related_operations_webhook*** provided buring BAP registration as below
	 - **POST** *np_user_related_operations_webhook*
Request body:
```json
{
 user_np_specific_id,
 documentsDeclared: [List of documents mentioned]
 purpose: documentVerificationDeclaration
}
```
- Its important to note, registry will **only accept** those verified documents from BAP, which are **mentioned by user on this step**.
- After this BAPs can separately verify the documents, once verified, they can declare it on network as below:
	 - **POST** *declareVerifiedDocumentToNetwork*
Request body:
```json
{
 user_np_specific_id,
 document_id,
 np_id,
 signature
}
```
- If a BAP wants to know about other declarared verified documents for a User on network they can use:
	 - **POST** *getAllDeclaredVerifiedDocumentListForUserOnNetwork*
Request body:
```json
{
 user_np_specific_id,
 document_ids: [Vector<document_id>] <optional: If not provided then all will be returned>,
 np_id,
 signature,
}
```
**NOTE**: Same can be used by BPP to query declarared verified documents on network as well. And they would be recorded for pricing purposes.
- To get the **url**, a BAP needs to get documents from another BAP:
	 - **POST** *getBapResourceUrl*
Request body:
```json
{
 queryUrlFor: [Vector<np_id>],
 np_id,
 signature,
}
```
- In the end, if BPP find one the documents false in cross verification then they can flag it on network using:
	 - **POST** *flagVerifiedDocumentInNetwork*
Request body:
```json
{
 documentsToFlag: [Vector<{ document_id, user_np_specific_id, bap_id}>],
 np_id,
 signature
}
```

------------
## **Flow**
- User visits BAP 
- User searches for scholarship
- User selects to view a scholarship.
- User gets Scholarship details 
- User clicks on APPLY
- Documents required Screens with Fetch my documents button at bottom 
	- User is redirected to DigiPramaan 
		- If USER is registered on Network then User enters ID & PIN on DigiPramaan page and logs in 
			- Show Documents available from the required list 
			- Show Document Upload flow for documents not verified 
		- Is USER is not registered on network, the register via mobile number 
			- Ask for Mobile number 
			- Ask for OTP to be entered
			- Ask for ID - DP screen
				- Check if ID available, if not ask for new ID - DP screen
			- Ask for PIN
			- Confirm PIN 
	- Redirect to Document upload page
- Successfully Submitted OR You dont have all required documents to apply for this Scholarship. Wait till the documents are verified. 

------------
## **Appendix**
- np_name: Network participant name(String)
- np_id: Network participant Id(String)
- np_public_key: Network participant public key out of key pair generated on np platform.(String)
- np_details: Network participant details(JSON)
- np_public_unique_identifier: Network participant unique identifier generated from registry (String, sensitive), np_id if provided
- upin: pin entered by user
- user_name: User name(String)
- user_phone: User phone(String)
- user_np_specific_id: User id specific to np mapped to user_unique_id(String)
- user_unique_id: Unique user id on onest network(String)
- signature: Created on platform with private key.(String)
- document_id: Document id for different document specified on this protocol(String)
- bpp_id: BPP id(provided by bpp during registration)(String)
- bpp_name: BPP name(provided by bpp during registration)(String)
- Vector: Array
